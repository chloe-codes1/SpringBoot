<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.example.demo.dao.BoardMapper1">

	<select id="getBoardList" resultType="com.example.demo.bean.Board1">
		select * from BoardList1 order by originno desc, groupord asc
	</select>
	
	<select id="getBoard" resultType="com.example.demo.bean.Board1">
		SELECT * FROM boardList1 WHERE boardno=#{boardno}
	</select>
	
	<select id="searchTitle" resultType="com.example.demo.bean.Board1">
		select * from BoardList1 WHERE UPPER(boardtitle) like UPPER('%'||#{keyword}||'%') order by originno desc, groupord asc
	</select>
	
	<select id="searchUserid" resultType="com.example.demo.bean.Board1">
		select * from BoardList1 WHERE UPPER(userid) like UPPER('%'||#{keyword}||'%') order by originno desc, groupord asc
	</select>
	
	
	<insert id="insertQ">
		INSERT INTO boardList1(userid, boardno, boardtitle, boardpw, contentp, regdate, originno, groupord,  grouplayer, countp) 
			VALUES( #{userid}, seq_board1.NEXTVAL, #{boardtitle}, #{boardpw}, #{contentp}, sysdate, seq_board1.currval, 0,  1, 0)
	</insert>
	
	<insert id="insertA">
		INSERT INTO boardList1(userid, boardtitle, boardno, boardpw, contentp, regdate, originno, groupord,  grouplayer, countp) 
			VALUES('${userid}', '${boardtitle}', seq_board1.NEXTVAL, '${boardpw}', '${contentp}', sysdate, ${originno}, ${groupord}, ${grouplayer}, 0)
	</insert>
	
	<update id="updateGrouplayer">
		UPDATE boardList1 SET groupord=groupord+1 WHERE originno=${originno} AND groupord>${groupord}
	</update>
	
	
	<delete id="deleteBoard">
		DELETE FROM boardList1 WHERE boardno=#{boardno}
	</delete>
	
	<update id="updateBoard">
		UPDATE boardList1 SET boardtitle=#{boardtitle}, boardpw=#{boardpw}, contentp=#{contentp} WHERE boardno=#{boardno}
	</update>
	
	
	<update id="updateCount">
		UPDATE boardList1 SET countp=countp+1 WHERE boardno=#{boardno}
	</update>
	
	
	<insert id="RegBoard4"
		parameterType="com.example.demo.bean.Board4">
		INSERT INTO board2(UserId, BoardNo,
		BoardTitle,Regdate,BoardPw,Imagesrc,Countp,Contentp)
		VALUES('kim',(select nvl(max(BoardNo),0)+1 from
		board2),#{BoardTitle},sysdate,#{BoardPw},#{Imagesrc},0,#{Contentp})
	</insert>

	<select id="looking4" resultType="Board4">
		select * from board2 ORDER BY
		BoardNo
	</select>

	<select id="detail4" resultType="Board4">
		select * from board2 where
		BoardNo=#{BoardNo}
	</select>

	<update id="updatecountp4"
		parameterType="com.example.demo.bean.Board4">
		update board2 SET Countp = Countp+1 where
		BoardNo=#{BoardNo}
	</update>


	<update id="UpdateBoard4"
		parameterType="com.example.demo.bean.Board4">
		update board SET BoardTitle = '${BoardTitle}', Contentp =
		'${Contentp}' WHERE BoardNo=${BoardNo} and BoardPw = '${BoardPw}'
	</update>

	<delete id="DeleteBoard4"
		parameterType="com.example.demo.bean.Board4">
		delete from Board2 where BoardNo=#{BoardNo} and
		BoardPW=#{BoardPw}
	</delete>

	<insert id="insertboard2"
		parameterType="com.example.demo.bean.Board2">
		insert into BoardList(userid, boardno, boardtitle,
		filesrc, regdate, boardpw , countp, contentp)
		values ('sung' ,
		seq_board.NEXTVAL, #{boardtitle}, #{filesrc}, sysdate ,
		#{boardpw},
		0,
		#{contentp})
	</insert>

	<select id="getBoardList2"
		resultType="com.example.demo.bean.Board2">
		select * from boardList order by boardno desc
	</select>
	
	<delete id="deleteboard2">
		delete from boardList where boardno=#{boardno}
	</delete>
	<update id="updateboard2">
		update boardList set countp = countp+1 where
		boardno =
		#{boardno}
	</update>
	<select id="detailboard2"
		resultType="com.example.demo.bean.Board2">
		select * from boardlist where boardno=#{boardno}
	</select>
	<update id="updateboard3">
		update boardList set boardtitle =#{boardtitle},
		contentp =#{contentp},
		regdate = sysdate
		where boardno=#{boardno}
	</update>
	<select id="searchboard2"
		resultType="com.example.demo.bean.Board2">
		select* from boardlist where
		UPPER(boardtitle) like UPPER('%'||#{boardtitle}||'%')
	</select>
	





<!-- 재훈 -->

<insert id="addBoard3" parameterType="Board3">
		insert into board
		(BOARD_NUM, BOARD_userid, BOARD_TITLE,
		BOARD_CONTENT,
		BOARD_IMG,board_parent
		)
		values(${board_num},
		'${board_userid}',
		'${board_title}',
		'${board_content}',
		'${board_img}',
		${board_parent}

		)
	</insert>

	
	


	<update id="countUp3" parameterType="int">
		update board set board_cnt = (select nvl(max(board_cnt), 0)+1 from board 
		where  board_num = ${board_num}) where board_num = ${board_num}
	</update>
	
	<update id="updateBoard33" parameterType="Board3" >
		update board set board_title = '${board_title}', 
		board_content = '${board_content}' , 
		board_img = '${board_img}' where board_num = ${board_num}
	</update>
	
	<select id="getSeq3" resultType="int">
		select nvl(max(board_num), 0)
		from board
	</select>

	<select id="boardList3" resultType="Board3">
	
		SELECT LPAD(' re:',
		4*(LEVEL-1)) || board_title board_title,
				<!-- || => 문자열을 더해줌 -->
				<!-- 앞의 문자열을 합쳐셔 board_title에 넣어줌 -->
		board_num,
		board_userid,
		board_cnt,
		board_date

		FROM board

		START WITH board_parent = 0

		CONNECT BY PRIOR board_num = board_parent
 		ORDER SIBLINGS BY board_date desc
	</select>

	<select id="boardView3" parameterType="int" resultType="Board3">
		select * from board where board_num = ${board_num}
	
	</select>
	
	<delete id="deleteBoard3" parameterType="int">
		delete board where board_num = ${board_num}
	</delete>
</mapper>